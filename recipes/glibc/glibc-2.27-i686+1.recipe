program="glibc"
version="2.27"
release="1"
arch="i686"

tarname=${program}-${version}.tar.xz

description="
The GNU C Library project provides the core libraries for the GNU 
system and GNU/Linux systems, as well as many other systems that use 
Linux as the kernel. These libraries provide critical APIs including 
ISO C11, POSIX.1-2008, BSD, OS-specific APIs and more. These APIs 
include such foundational facilities as open, read, write, malloc, 
printf, getaddrinfo, dlopen, pthread_create, crypt, login, exit and more. 
---
"

build() {

. /home/0-variables-build-flags

unpack "${tardir}/$tarname"
cd "$srcdir"

echo -e "\nInstalacion de $srcdir 32 Bit"

LINKER=$(readelf -l /tools/bin/bash | sed -n 's@.*interpret.*/tools\(.*\)]$@\1@p')
sed -i "s|libs -o|libs -L/usr/lib -Wl,-dynamic-linker=${LINKER} -o|" \
  scripts/test-installation.pl
unset LINKER

cp -v timezone/Makefile{,.orig}
sed 's/\\$$(pwd)/`pwd`/' timezone/Makefile.orig > timezone/Makefile
registro_error "timezone"

if [ -d "build" ] ; then
	rm -rv "build"
fi

mkdir build
cd build

CC="gcc ${BUILD32}" \
CXX="g++ ${BUILD32}" \
../configure \
--prefix=/usr \
--disable-profile \
--enable-kernel=4.10 \
--libexecdir=/usr/lib/glibc \
--host=${CLFS_TARGET32} \
--enable-obsolete-rpc \
--enable-obsolete-nsl


make

sed -i '/cross-compiling/s@ifeq@ifneq@g' ../localedata/Makefile
#make -k check 2>&1 | tee $FILE_CHECKS; grep Error $FILE_CHECKS

touch ${destdir}/etc/ld.so.conf

make install DESTDIR=${destdir}

rm -v ${destdir}/usr/include/rpcsvc/*.x

cp -v ../nscd/nscd.conf ${destdir}/etc/nscd.conf

mkdir -pv ${destdir}/var/cache/nscd


}











